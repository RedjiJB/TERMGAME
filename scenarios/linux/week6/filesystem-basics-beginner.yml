mission:
  id: "filesystem-basics-beginner"
  title: "Linux Filesystem Basics"
  difficulty: "beginner"
  description: |
    Learn the fundamentals of the Linux filesystem - directory structure, file types,
    and basic operations. Understand how Linux organizes files and directories.

    Essential foundation for navigating and managing Linux systems!
  estimated_time: "30 minutes"
  xp_reward: 250
  tags:
    - "filesystem"
    - "files"
    - "directories"
    - "basics"
    - "week6"

environment:
  runtime: "docker"
  base_image: "ubuntu:22.04"
  setup: |
    apt-get update && apt-get install -y \
      coreutils \
      tree \
      file

steps:
  - id: "filesystem-hierarchy"
    description: |
      **Linux Filesystem Hierarchy**

      Linux uses a single hierarchical directory tree, starting at root (/).

      **Key directories:**
      ```
      /           Root - top of the filesystem
      ├── bin     Essential user commands (ls, cat, etc.)
      ├── etc     System configuration files
      ├── home    User home directories
      ├── root    Root user's home directory
      ├── tmp     Temporary files
      ├── usr     User programs and data
      ├── var     Variable data (logs, databases)
      └── opt     Optional software packages
      ```

      **Everything is a file:**
      - Regular files (documents, programs)
      - Directories (special files that contain other files)
      - Devices (/dev/sda1, /dev/null)
      - Links (shortcuts to other files)

      **Task:** Explore the filesystem structure.

      ```bash
      mkdir -p ~/filesystem_practice
      cd ~/filesystem_practice

      # Document key directories
      cat > filesystem_map.txt << 'EOF'
      Linux Filesystem Structure
      ===========================

      Root Directory Contents:
      EOF

      ls -1 / >> filesystem_map.txt

      echo "" >> filesystem_map.txt
      echo "My current location:" >> filesystem_map.txt
      pwd >> filesystem_map.txt

      cat filesystem_map.txt
      ```
    hint: |
      Use 'ls /' to see the root directory contents. The root (/) is the top
      of the entire filesystem hierarchy.
    validation:
      - type: "file-exists"
        path: "~/filesystem_practice/filesystem_map.txt"

  - id: "understanding-paths"
    description: |
      **Absolute vs Relative Paths**

      **Absolute path:**
      - Starts with /
      - Full path from root
      - Example: `/home/user/documents/file.txt`

      **Relative path:**
      - Doesn't start with /
      - Relative to current directory
      - Example: `documents/file.txt` or `../other/file.txt`

      **Special path components:**
      - `.` (dot) = current directory
      - `..` (dot-dot) = parent directory
      - `~` (tilde) = home directory
      - `-` (dash) = previous directory

      **Examples:**
      ```bash
      pwd                    # Where am I?
      ls .                   # List current directory
      ls ..                  # List parent directory
      cd ~                   # Go to home
      cd /etc                # Go to /etc (absolute)
      cd ../tmp              # Go to sibling directory (relative)
      ```

      **Task:** Practice with paths.

      ```bash
      # Create a directory structure
      mkdir -p ~/filesystem_practice/level1/level2/level3

      # Navigate and document
      cd ~/filesystem_practice/level1/level2/level3

      cat > paths_demo.txt << EOF
      Path Navigation Demo
      ====================

      Current directory (pwd):
      $(pwd)

      Absolute path to this file:
      $(pwd)/paths_demo.txt

      Parent directory (..):
      $(cd .. && pwd)

      Grandparent directory (../ ..):
      $(cd ../.. && pwd)

      Home directory (~):
      $(cd ~ && pwd)
      EOF

      cat paths_demo.txt
      ```
    hint: |
      Absolute paths always start with /, relative paths don't. Use 'pwd' to
      see your current location.
    validation:
      - type: "file-exists"
        path: "~/filesystem_practice/level1/level2/level3/paths_demo.txt"

  - id: "file-types"
    description: |
      **Understanding File Types**

      Linux has several file types, indicated by the first character in `ls -l`:

      ```
      -   Regular file
      d   Directory
      l   Symbolic link
      c   Character device
      b   Block device
      p   Named pipe (FIFO)
      s   Socket
      ```

      **Identifying file types:**
      ```bash
      # List with types
      ls -l

      # The 'file' command tells you what a file contains
      file /bin/ls       # ELF executable
      file /etc/passwd   # ASCII text
      file /dev/null     # Character device
      ```

      **Task:** Explore file types.

      ```bash
      cd ~/filesystem_practice

      # Create various file types
      touch regular_file.txt                    # Regular file
      mkdir directory_example                   # Directory
      ln -s regular_file.txt link_example       # Symbolic link

      # Analyze file types
      echo "File Type Analysis" > file_types.txt
      echo "==================" >> file_types.txt
      echo "" >> file_types.txt

      # Use ls -l to show types
      ls -l | grep -E "regular_file|directory|link" >> file_types.txt

      echo "" >> file_types.txt
      echo "Using 'file' command:" >> file_types.txt
      file regular_file.txt >> file_types.txt
      file directory_example >> file_types.txt
      file link_example >> file_types.txt

      cat file_types.txt
      ```
    hint: |
      In 'ls -l' output, the first character shows the type: '-' for regular
      file, 'd' for directory, 'l' for link. The 'file' command provides details.
    validation:
      - type: "file-exists"
        path: "~/filesystem_practice/file_types.txt"

  - id: "file-permissions-intro"
    description: |
      **Introduction to File Permissions**

      Every file has permissions that control who can read, write, or execute it.

      **Permission format in ls -l:**
      ```
      -rwxr-xr-x  1 user group  4096 Jan 1 10:00 filename
       ^^^───┬───^ │  │    │     │     └─ Filename
       │     └─────┼──┘    │     └─ Size in bytes
       │           │       └─ Group owner
       │           └─ User owner
       └─ Permissions (10 characters)
      ```

      **Permission breakdown:**
      ```
      -rwxr-xr-x
      │││││││││└─ Others: execute
      ││││││││└── Others: write (none)
      │││││││└─── Others: read
      ││││││└──── Group: execute
      │││││└───── Group: write (none)
      ││││└────── Group: read
      │││└─────── Owner: execute
      ││└──────── Owner: write
      │└───────── Owner: read
      └────────── File type (- = regular file)
      ```

      **Permission meanings:**
      - `r` (read) = View file contents / List directory
      - `w` (write) = Modify file / Create/delete files in directory
      - `x` (execute) = Run as program / Enter directory

      **Task:** Examine permissions.

      ```bash
      cd ~/filesystem_practice

      # Create files with different permissions
      touch readable.txt writable.txt executable.sh
      echo "This file is readable" > readable.txt
      echo "This file is writable" > writable.txt
      echo "#!/bin/bash\necho 'I am executable'" > executable.sh

      # Set different permissions
      chmod 644 readable.txt      # rw-r--r--
      chmod 666 writable.txt      # rw-rw-rw-
      chmod 755 executable.sh     # rwxr-xr-x

      # Document permissions
      echo "File Permissions Example" > permissions.txt
      echo "========================" >> permissions.txt
      echo "" >> permissions.txt
      ls -l readable.txt writable.txt executable.sh >> permissions.txt

      echo "" >> permissions.txt
      echo "Permission Meanings:" >> permissions.txt
      echo "r = read (4)" >> permissions.txt
      echo "w = write (2)" >> permissions.txt
      echo "x = execute (1)" >> permissions.txt

      cat permissions.txt
      ```
    hint: |
      Use 'ls -l' to see permissions. The format is: file type, then three sets
      of rwx (owner, group, others). chmod changes permissions.
    validation:
      - type: "file-exists"
        path: "~/filesystem_practice/permissions.txt"

  - id: "working-with-directories"
    description: |
      **Directory Operations**

      Common directory operations:

      **Creating directories:**
      ```bash
      mkdir dirname           # Create single directory
      mkdir -p dir1/dir2      # Create parent directories as needed
      mkdir dir1 dir2 dir3    # Create multiple directories
      ```

      **Removing directories:**
      ```bash
      rmdir dirname           # Remove empty directory
      rm -r dirname           # Remove directory and contents
      rm -rf dirname          # Force remove (be careful!)
      ```

      **Copying and moving:**
      ```bash
      cp file1 file2          # Copy file
      cp -r dir1 dir2         # Copy directory recursively
      mv file1 file2          # Move/rename file
      mv dir1 dir2            # Move/rename directory
      ```

      **Task:** Practice directory operations.

      ```bash
      cd ~/filesystem_practice

      # Create directory structure
      mkdir -p projects/project1/src
      mkdir -p projects/project1/docs
      mkdir -p projects/project2

      # Create some files
      echo "Source code" > projects/project1/src/main.txt
      echo "Documentation" > projects/project1/docs/README.txt

      # Copy directory
      cp -r projects/project1 projects/project1-backup

      # Document the structure
      echo "Directory Operations Demo" > dir_ops.txt
      echo "=========================" >> dir_ops.txt
      echo "" >> dir_ops.txt

      # Show directory tree (if tree is available)
      if command -v tree &> /dev/null; then
        tree projects >> dir_ops.txt
      else
        # Alternative using find
        find projects -print >> dir_ops.txt
      fi

      echo "" >> dir_ops.txt
      echo "Operations performed:" >> dir_ops.txt
      echo "- Created nested directories with mkdir -p" >> dir_ops.txt
      echo "- Created files in subdirectories" >> dir_ops.txt
      echo "- Copied entire directory tree with cp -r" >> dir_ops.txt

      cat dir_ops.txt
      ```
    hint: |
      Use 'mkdir -p' to create nested directories in one command. Use 'cp -r'
      for recursive copying of directories. The -r flag means "recursive".
    validation:
      - type: "file-exists"
        path: "~/filesystem_practice/dir_ops.txt"

  - id: "finding-files"
    description: |
      **Finding Files in the Filesystem**

      **Using find:**
      ```bash
      # Find by name
      find /path -name "filename"

      # Find by type
      find /path -type f          # Files
      find /path -type d          # Directories

      # Find by size
      find /path -size +1M        # Larger than 1MB
      find /path -size -1k        # Smaller than 1KB

      # Find and execute command
      find /path -name "*.txt" -exec cat {} \;
      ```

      **Using locate (faster but needs database):**
      ```bash
      locate filename             # Search entire filesystem
      ```

      **Using which (for commands):**
      ```bash
      which ls                    # Find command location
      which python
      ```

      **Task:** Practice finding files.

      ```bash
      cd ~/filesystem_practice

      # Create files to find
      touch file1.txt file2.txt file3.log
      mkdir -p search/subdir
      touch search/test.txt search/subdir/deep.txt

      # Find files
      echo "File Finding Examples" > find_demo.txt
      echo "=====================" >> find_demo.txt
      echo "" >> find_demo.txt

      echo "Find all .txt files:" >> find_demo.txt
      find ~/filesystem_practice -name "*.txt" >> find_demo.txt

      echo "" >> find_demo.txt
      echo "Find all directories:" >> find_demo.txt
      find ~/filesystem_practice -type d >> find_demo.txt

      echo "" >> find_demo.txt
      echo "Find command locations:" >> find_demo.txt
      which ls >> find_demo.txt
      which bash >> find_demo.txt

      cat find_demo.txt
      ```

      **Congratulations!** You now understand Linux filesystem basics!

      **You learned:**
      - Linux filesystem hierarchy and structure
      - Absolute vs relative paths
      - Different file types and how to identify them
      - File permissions and what they mean
      - Directory operations (create, copy, move, remove)
      - Finding files using find and which

      **Key concepts to remember:**
      - Everything is a file in Linux
      - The filesystem starts at root (/)
      - Use absolute paths for precision, relative for convenience
      - Permissions control access (read, write, execute)
      - Always be careful with recursive operations (rm -r, cp -r)

      You're now ready for more advanced filesystem operations!
    hint: |
      'find' searches from a starting directory. Use '-name' for filenames,
      '-type' for file types. 'which' finds commands in your PATH.
    validation:
      - type: "file-exists"
        path: "~/filesystem_practice/find_demo.txt"
